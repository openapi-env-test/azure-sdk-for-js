/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License. See License.txt in the project root for
 * license information.
 *
 * Code generated by Microsoft (R) AutoRest Code Generator.
 * Changes may cause incorrect behavior and will be lost if the code is
 * regenerated.
 */

import * as msRest from "@azure/ms-rest-js";
import * as Models from "./models";
import * as Mappers from "./models/mappers";
import * as Parameters from "./models/parameters";
import { BatchTextTranslationAPIContext } from "./batchTextTranslationAPIContext";

class BatchTextTranslationAPI extends BatchTextTranslationAPIContext {
  /**
   * Initializes a new instance of the BatchTextTranslationAPI class.
   * @param credentials Subscription credentials which uniquely identify client subscription.
   * @param [options] The parameter options
   */
  constructor(credentials: msRest.ServiceClientCredentials, options?: Models.BatchTextTranslationAPIOptions) {
    super(credentials, options);
  }

  /**
   * Submit a batch request to the document translation service.
   * User can specify a list of target languages to be translated to.
   *
   * A batch request can consist of 1-n input source folders.
   * The prefix and suffix filter (if supplied) will be used to filter the folders.
   * ///
   * We will create subfolder for each target language.
   * For Example, if the input is https://[myblob]/container/ and destination output is
   * https://[myblob]/outputcontainer/
   * and the container contains 2 files a.txt, b.docx.  The translation is from en to [es,fr]
   * The documents translated will be placed in
   * https://[myblob]/outputcontainer/es/a.txt
   * https://[myblob]/outputcontainer/es/b.docx
   * https://[myblob]/outputcontainer/fr/a.txt
   * https://[myblob]/outputcontainer/fr/b.docx
   *
   * If the file with the same name already exists, it will be overwritten.
   *
   * A status file will also be written in the root folder.
   * @summary Submit a batch document translation request to the translation service
   * @param [options] The optional parameters
   * @returns Promise<Models.BatchDocumentsSubmitResponse>
   */
  batchDocumentsSubmit(options?: Models.BatchTextTranslationAPIBatchDocumentsSubmitOptionalParams): Promise<Models.BatchDocumentsSubmitResponse>;
  /**
   * @param callback The callback
   */
  batchDocumentsSubmit(callback: msRest.ServiceCallback<any>): void;
  /**
   * @param options The optional parameters
   * @param callback The callback
   */
  batchDocumentsSubmit(options: Models.BatchTextTranslationAPIBatchDocumentsSubmitOptionalParams, callback: msRest.ServiceCallback<any>): void;
  batchDocumentsSubmit(options?: Models.BatchTextTranslationAPIBatchDocumentsSubmitOptionalParams | msRest.ServiceCallback<any>, callback?: msRest.ServiceCallback<any>): Promise<Models.BatchDocumentsSubmitResponse> {
    return this.sendOperationRequest(
      {
        options
      },
      batchDocumentsSubmitOperationSpec,
      callback) as Promise<Models.BatchDocumentsSubmitResponse>;
  }

  /**
   * Use content-type header to denote the file format type
   *
   * Example:
   * text/plain for .txt files
   * application/vnd.openxmlformats-officedocument.wordprocessingml.document for .docx files
   * application/pdf for .pdf files
   * @summary Submit a binary document in the POST body to the translation service.
   * @param to The language code for the documents to translate to
   * @param [options] The optional parameters
   * @returns Promise<Models.SingleDocumentUploadResponse>
   */
  singleDocumentUpload(to: string, options?: Models.BatchTextTranslationAPISingleDocumentUploadOptionalParams): Promise<Models.SingleDocumentUploadResponse>;
  /**
   * @param to The language code for the documents to translate to
   * @param callback The callback
   */
  singleDocumentUpload(to: string, callback: msRest.ServiceCallback<any>): void;
  /**
   * @param to The language code for the documents to translate to
   * @param options The optional parameters
   * @param callback The callback
   */
  singleDocumentUpload(to: string, options: Models.BatchTextTranslationAPISingleDocumentUploadOptionalParams, callback: msRest.ServiceCallback<any>): void;
  singleDocumentUpload(to: string, options?: Models.BatchTextTranslationAPISingleDocumentUploadOptionalParams | msRest.ServiceCallback<any>, callback?: msRest.ServiceCallback<any>): Promise<Models.SingleDocumentUploadResponse> {
    return this.sendOperationRequest(
      {
        to,
        options
      },
      singleDocumentUploadOperationSpec,
      callback) as Promise<Models.SingleDocumentUploadResponse>;
  }

  /**
   * Returns the status of the translation of the document.
   * Note: there will be one document detail for each translated to language operations
   * @summary Returns the status of the specific document
   * @param documentId Format - int64.  The document id
   * @param [options] The optional parameters
   * @returns Promise<Models.GetDocumentStatusResponse>
   */
  getDocumentStatus(documentId: number, options?: msRest.RequestOptionsBase): Promise<Models.GetDocumentStatusResponse>;
  /**
   * @param documentId Format - int64.  The document id
   * @param callback The callback
   */
  getDocumentStatus(documentId: number, callback: msRest.ServiceCallback<any>): void;
  /**
   * @param documentId Format - int64.  The document id
   * @param options The optional parameters
   * @param callback The callback
   */
  getDocumentStatus(documentId: number, options: msRest.RequestOptionsBase, callback: msRest.ServiceCallback<any>): void;
  getDocumentStatus(documentId: number, options?: msRest.RequestOptionsBase | msRest.ServiceCallback<any>, callback?: msRest.ServiceCallback<any>): Promise<Models.GetDocumentStatusResponse> {
    return this.sendOperationRequest(
      {
        documentId,
        options
      },
      getDocumentStatusOperationSpec,
      callback) as Promise<Models.GetDocumentStatusResponse>;
  }

  /**
   * Returns the status of the translation batch operation.
   * The status will include the overall job status as well as a summary of the current progress of
   * all the documents being translated.
   * @summary Returns the status of the batch translation operation
   * @param id Format - uuid.  The operation id
   * @param [options] The optional parameters
   * @returns Promise<Models.GetOperationStatusResponse>
   */
  getOperationStatus(id: string, options?: msRest.RequestOptionsBase): Promise<Models.GetOperationStatusResponse>;
  /**
   * @param id Format - uuid.  The operation id
   * @param callback The callback
   */
  getOperationStatus(id: string, callback: msRest.ServiceCallback<any>): void;
  /**
   * @param id Format - uuid.  The operation id
   * @param options The optional parameters
   * @param callback The callback
   */
  getOperationStatus(id: string, options: msRest.RequestOptionsBase, callback: msRest.ServiceCallback<any>): void;
  getOperationStatus(id: string, options?: msRest.RequestOptionsBase | msRest.ServiceCallback<any>, callback?: msRest.ServiceCallback<any>): Promise<Models.GetOperationStatusResponse> {
    return this.sendOperationRequest(
      {
        id,
        options
      },
      getOperationStatusOperationSpec,
      callback) as Promise<Models.GetOperationStatusResponse>;
  }

  /**
   * Cancel a currently processing or queued operation.
   * An operation will not be cancelled if it is already completed or failed.
   * All documents that have completed translation will not be cancelled and will be charged.
   * All pending documents will be cancelled if possible.
   * @summary Cancel a currently processing or queued operation.
   * @param id Format - uuid.  The operation-id
   * @param [options] The optional parameters
   * @returns Promise<Models.CancelOperationResponse>
   */
  cancelOperation(id: string, options?: msRest.RequestOptionsBase): Promise<Models.CancelOperationResponse>;
  /**
   * @param id Format - uuid.  The operation-id
   * @param callback The callback
   */
  cancelOperation(id: string, callback: msRest.ServiceCallback<any>): void;
  /**
   * @param id Format - uuid.  The operation-id
   * @param options The optional parameters
   * @param callback The callback
   */
  cancelOperation(id: string, options: msRest.RequestOptionsBase, callback: msRest.ServiceCallback<any>): void;
  cancelOperation(id: string, options?: msRest.RequestOptionsBase | msRest.ServiceCallback<any>, callback?: msRest.ServiceCallback<any>): Promise<Models.CancelOperationResponse> {
    return this.sendOperationRequest(
      {
        id,
        options
      },
      cancelOperationOperationSpec,
      callback) as Promise<Models.CancelOperationResponse>;
  }

  /**
   * Returns the status of the translation batch operation.
   * The status will include the overall operation status as well as a summary of the current
   * progress of the documents being translated.
   *
   * The documents are sorted by the document Id and then the translate to language
   *
   * If the number of documents exceed our paging limit, server side paging will be used.
   * Paginated responses will indicate a partial result by including a continuation token in the
   * response. The absence of a continuation token means that no additional pages are available.
   *
   * Clients MAY use $top and $skip query parameters to specify a number of results to return and an
   * offset into the collection.
   * The server will honor the values specified by the client; however, clients MUST be prepared to
   * handle responses that contain a different page size or contain a continuation token.
   * When both $top and $skip are given by a client, the server SHOULD first apply $skip and then
   * $top on the collection.
   * Note: If the server can't honor $top and/or $skip, the server MUST return an error to the client
   * informing about it instead of just ignoring the query options. This will avoid the risk of the
   * client making assumptions about the data returned.
   * @summary Returns the status of the documents of a translation batch operation
   * @param id Format - uuid.  The operation id
   * @param [options] The optional parameters
   * @returns Promise<Models.GetDetailedDocumentStatusResponse>
   */
  getDetailedDocumentStatus(id: string, options?: Models.BatchTextTranslationAPIGetDetailedDocumentStatusOptionalParams): Promise<Models.GetDetailedDocumentStatusResponse>;
  /**
   * @param id Format - uuid.  The operation id
   * @param callback The callback
   */
  getDetailedDocumentStatus(id: string, callback: msRest.ServiceCallback<any>): void;
  /**
   * @param id Format - uuid.  The operation id
   * @param options The optional parameters
   * @param callback The callback
   */
  getDetailedDocumentStatus(id: string, options: Models.BatchTextTranslationAPIGetDetailedDocumentStatusOptionalParams, callback: msRest.ServiceCallback<any>): void;
  getDetailedDocumentStatus(id: string, options?: Models.BatchTextTranslationAPIGetDetailedDocumentStatusOptionalParams | msRest.ServiceCallback<any>, callback?: msRest.ServiceCallback<any>): Promise<Models.GetDetailedDocumentStatusResponse> {
    return this.sendOperationRequest(
      {
        id,
        options
      },
      getDetailedDocumentStatusOperationSpec,
      callback) as Promise<Models.GetDetailedDocumentStatusResponse>;
  }

  /**
   * The list of supported document formats supported by our service.
   * The list will include the common file extension used and supported as well as the content-type
   * if using the upload API.
   * @summary Returns the list of supported document formats
   * @param [options] The optional parameters
   * @returns Promise<Models.GetDocumentFormatsResponse>
   */
  getDocumentFormats(options?: msRest.RequestOptionsBase): Promise<Models.GetDocumentFormatsResponse>;
  /**
   * @param callback The callback
   */
  getDocumentFormats(callback: msRest.ServiceCallback<{ [propertyName: string]: Models.DocumentFormat[] }>): void;
  /**
   * @param options The optional parameters
   * @param callback The callback
   */
  getDocumentFormats(options: msRest.RequestOptionsBase, callback: msRest.ServiceCallback<{ [propertyName: string]: Models.DocumentFormat[] }>): void;
  getDocumentFormats(options?: msRest.RequestOptionsBase | msRest.ServiceCallback<{ [propertyName: string]: Models.DocumentFormat[] }>, callback?: msRest.ServiceCallback<{ [propertyName: string]: Models.DocumentFormat[] }>): Promise<Models.GetDocumentFormatsResponse> {
    return this.sendOperationRequest(
      {
        options
      },
      getDocumentFormatsOperationSpec,
      callback) as Promise<Models.GetDocumentFormatsResponse>;
  }

  /**
   * The list of storage sources supported by our service.
   * @summary Returns the list of supported storage sources
   * @param [options] The optional parameters
   * @returns Promise<Models.GetStorageSourcesThatWeCurrentlySupportResponse>
   */
  getStorageSourcesThatWeCurrentlySupport(options?: msRest.RequestOptionsBase): Promise<Models.GetStorageSourcesThatWeCurrentlySupportResponse>;
  /**
   * @param callback The callback
   */
  getStorageSourcesThatWeCurrentlySupport(callback: msRest.ServiceCallback<{ [propertyName: string]: string[] }>): void;
  /**
   * @param options The optional parameters
   * @param callback The callback
   */
  getStorageSourcesThatWeCurrentlySupport(options: msRest.RequestOptionsBase, callback: msRest.ServiceCallback<{ [propertyName: string]: string[] }>): void;
  getStorageSourcesThatWeCurrentlySupport(options?: msRest.RequestOptionsBase | msRest.ServiceCallback<{ [propertyName: string]: string[] }>, callback?: msRest.ServiceCallback<{ [propertyName: string]: string[] }>): Promise<Models.GetStorageSourcesThatWeCurrentlySupportResponse> {
    return this.sendOperationRequest(
      {
        options
      },
      getStorageSourcesThatWeCurrentlySupportOperationSpec,
      callback) as Promise<Models.GetStorageSourcesThatWeCurrentlySupportResponse>;
  }
}

// Operation Specifications
const serializer = new msRest.Serializer(Mappers);
const batchDocumentsSubmitOperationSpec: msRest.OperationSpec = {
  httpMethod: "POST",
  path: "translator/text/batch/v1.0-preview.1/documents",
  requestBody: {
    parameterPath: [
      "options",
      "body"
    ],
    mapper: Mappers.JobSubmissionBatchRequest
  },
  responses: {
    201: {
      bodyMapper: Mappers.OperationStatusResponse
    },
    400: {
      bodyMapper: Mappers.ErrorResponseV2
    },
    default: {}
  },
  serializer
};

const singleDocumentUploadOperationSpec: msRest.OperationSpec = {
  httpMethod: "POST",
  path: "translator/text/batch/v1.0-preview.1/documents/upload",
  queryParameters: [
    Parameters.to,
    Parameters.from,
    Parameters.category
  ],
  responses: {
    201: {
      bodyMapper: Mappers.DocumentSubmissionResponse,
      headersMapper: Mappers.SingleDocumentUploadHeaders
    },
    400: {
      bodyMapper: Mappers.ErrorResponseV2,
      headersMapper: Mappers.SingleDocumentUploadHeaders
    },
    default: {}
  },
  serializer
};

const getDocumentStatusOperationSpec: msRest.OperationSpec = {
  httpMethod: "GET",
  path: "translator/text/batch/v1.0-preview.1/documents/{documentId}",
  urlParameters: [
    Parameters.documentId
  ],
  responses: {
    200: {
      bodyMapper: Mappers.DocumentStatusResponse,
      headersMapper: Mappers.GetDocumentStatusHeaders
    },
    404: {
      bodyMapper: Mappers.ErrorResponseV2,
      headersMapper: Mappers.GetDocumentStatusHeaders
    },
    default: {}
  },
  serializer
};

const getOperationStatusOperationSpec: msRest.OperationSpec = {
  httpMethod: "GET",
  path: "translator/text/batch/v1.0-preview.1/operations/{id}",
  urlParameters: [
    Parameters.id
  ],
  responses: {
    200: {
      bodyMapper: Mappers.OperationStatusResponse,
      headersMapper: Mappers.GetOperationStatusHeaders
    },
    404: {
      bodyMapper: Mappers.ErrorResponseV2,
      headersMapper: Mappers.GetOperationStatusHeaders
    },
    default: {}
  },
  serializer
};

const cancelOperationOperationSpec: msRest.OperationSpec = {
  httpMethod: "DELETE",
  path: "translator/text/batch/v1.0-preview.1/operations/{id}",
  urlParameters: [
    Parameters.id
  ],
  responses: {
    200: {
      bodyMapper: Mappers.OperationStatusResponse
    },
    404: {
      bodyMapper: Mappers.ErrorResponseV2
    },
    default: {}
  },
  serializer
};

const getDetailedDocumentStatusOperationSpec: msRest.OperationSpec = {
  httpMethod: "GET",
  path: "translator/text/batch/v1.0-preview.1/operations/{id}/documents",
  urlParameters: [
    Parameters.id
  ],
  queryParameters: [
    Parameters.top,
    Parameters.skip
  ],
  responses: {
    200: {
      bodyMapper: Mappers.DocumentStatusResponse,
      headersMapper: Mappers.GetDetailedDocumentStatusHeaders
    },
    400: {
      bodyMapper: Mappers.ErrorResponseV2,
      headersMapper: Mappers.GetDetailedDocumentStatusHeaders
    },
    404: {
      bodyMapper: Mappers.ErrorResponseV2,
      headersMapper: Mappers.GetDetailedDocumentStatusHeaders
    },
    default: {}
  },
  serializer
};

const getDocumentFormatsOperationSpec: msRest.OperationSpec = {
  httpMethod: "GET",
  path: "translator/text/batch/v1.0-preview.1/documents/formats",
  responses: {
    200: {
      bodyMapper: {
        serializedName: "parsedResponse",
        type: {
          name: "Dictionary",
          value: {
            type: {
              name: "Sequence",
              element: {
                type: {
                  name: "Composite",
                  className: "DocumentFormat"
                }
              }
            }
          }
        }
      }
    },
    default: {}
  },
  serializer
};

const getStorageSourcesThatWeCurrentlySupportOperationSpec: msRest.OperationSpec = {
  httpMethod: "GET",
  path: "translator/text/batch/v1.0-preview.1/storagesources",
  responses: {
    200: {
      bodyMapper: {
        serializedName: "parsedResponse",
        type: {
          name: "Dictionary",
          value: {
            type: {
              name: "Sequence",
              element: {
                type: {
                  name: "String"
                }
              }
            }
          }
        }
      }
    },
    default: {}
  },
  serializer
};

export {
  BatchTextTranslationAPI,
  BatchTextTranslationAPIContext,
  Models as BatchTextTranslationAPIModels,
  Mappers as BatchTextTranslationAPIMappers
};
